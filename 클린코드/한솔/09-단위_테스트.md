9장. 단위 테스트
============

## TDD 법칙 세 가지
1. 실패하는 단위 테스트를 작성할 때까지 실제 코드를 작성하지 않는다.
2. 컴파일은 실패하지 않으면서 실행이 실패하는 정도로 작성한다.
3. 현재 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다.

## 깨끗한 테스트 코드 유지하기
- 일회용 테스트 코드를 짜오다가 새삼스레 자동화된 단위 테스트 슈트를 짜는 것은 어렵다.
- 지저분한 테스트 코드는 변경하기 어렵다.

## 테스트는 유연성, 유지보수성, 재사용성을 제공한다.
- 단위 테스트는 실제 코드를 유연하게 도와준다. 변경이 쉬워진다. 테스트 케이스가 없다면 모든 변경이 잠정적인 버그다.

## 깨끗한 테스트 코드
- 가독성, 가독성이 중요하다.
- 자질구레한 사항이 많은 경우 테스트 코드의 표현력이 떨어진다.   
    ```
        addPage(...)
        addPage(...)
        assertSubString(...)
        addPage(...)
        assertSubString(...)
        addPage(...)
        assertSubString(...)    
    ```
    x
    ```
    PathParser 문자열을 pagePath 인스턴스로 변환한다.
    pagePath는 웹 로봇이 사용하는 객체
    
    responder 객체를 생성하는 코드와 response를 수집해 변환하는 코드
    
    resource와 인수에서 요청 URL을 만드는 코드
    ```
    BUILD-OPERATE_CHECK 패턴으로 3가지를 분리한다.
    : 테스트 자료를 만든다. 테스트 자료를 조작한다. 조작한 결과가 올바른지 확인한다.

## 도메인에 특화된 테슽 ㅡ언어
- API 위에다 함수와 유틸리티를 구현하여 사용
- 리팩토링을 통해 테스트 API가 진화된다.

## 이중 표준
- 테스트 API와 실제 코드에 적용하는 표준은 다르다.
- 테스트 API 코드는    
    ```
    assertTrue
    assertTrue
    assertFalse
    assertTrue
    assertTrue
    ```
    x
    ```
    assertEquals("HBchL", ...)
    ```
    대문자는 True 소문자는 False를 나타낸다.
    
    또는
    ```
    ...getState();
    ...getState();
    ...getState();
    ```
    getState(): 문자를 저장한다.
  
    대신에
  
    StringBuffer를 사용한다.
    테스트 환경은 자원이 제한적일 가능성이 낮기 때문

## 테스트당 assert 하나
- given-when-then이라는 관례를 사용
    given/when 을 부모 클래스에 두거나 @Before 함수에 넣는다.
    then 을 자식 클래스에 두거나 @Test 함수에 넣는다.
- assert 문 개수는 최대한 줄여야 한다.

## 테스트당 개념 하나
- 테스트 함수마다 한 개념만 테스트하라

## F.I.R.S.T
- 빠르게(Fast): 테스트가 느리면 자주 돌릴 엄두를 못 낸다.
- 독립적으로(Independent): 각 테스트는 서로 의존하면 안되고 어떤 순서로 실행해도 괜찮아야 한다.
- 반복가능하게(Repeatable): 어떤 환경에서도 반복 가능해야 한다.
- 자가검증하는(Self-Validating): 부울 값으로 결과를 내야 한다. 성공 아님 실패, 그렇지 않으면 판단이 주관적이 된다.
- 적시에(Timely): 테스트하려는 실제 코드를 구현하기 직전에 구현한다. 그렇지 않으면 테스트 코드를 만들기 어렵다고 생각한다.
